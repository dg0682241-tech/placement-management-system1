{% extends "base.html" %}
{% block content %}

<style>
  /* ================= HEADING ================= */
  .glass-heading {
    font-weight: 900;
    letter-spacing: 2px;
    font-size: 2.8rem; /* BIG heading */
    transition: color .3s ease;
  }

  .glass-heading:hover {
    color: #0d6efd;
  }

  /* ================= BUTTON STYLES ================= */

  /* Download Resume Button */
  .resume-btn {
    background-color: #0d6efd;
    color: #fff;
    border: 2px solid #0a58ca;
    border-radius: 999px;
    padding: 6px 16px;
    font-weight: 600;
    transition: all 0.3s ease;
  }

  .resume-btn:hover {
    background-color: #0a58ca;
    transform: scale(1.1);
    box-shadow: 0 4px 12px rgba(13,110,253,0.45);
  }

  /* Update Button */
  .update-btn {
    background-color: #198754;
    color: #fff;
    border: 2px solid #146c43;
    border-radius: 999px;
    padding: 6px 16px;
    font-weight: 600;
    transition: all 0.3s ease;
  }

  .update-btn:hover {
    background-color: #146c43;
    transform: scale(1.1);
    box-shadow: 0 4px 12px rgba(25,135,84,0.45);
  }

  /* ================= TABLE ================= */
  .glass-table {
    background: rgba(255,255,255,0.25);
    backdrop-filter: blur(10px);
  }

  table th, table td {
    padding: 14px 12px;
    vertical-align: middle;
  }

  /* ================= MOBILE STACKED VIEW ================= */
  @media (max-width: 768px) {

    table thead {
      display: none;
    }

    table tbody tr {
      display: block;
      margin-bottom: 1rem;
      border-radius: 14px;
      background: rgba(255, 255, 255, 0.95);
      box-shadow: 0 4px 14px rgba(0,0,0,0.1);
      padding: 12px;
    }

    table tbody td {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 8px 6px;
      border: none;
      font-size: 14px;
    }

    table tbody td::before {
      content: attr(data-label);
      font-weight: 600;
      color: #555;
    }

    table tbody td:first-child {
      display: none;
    }

    table tbody td form {
      width: 100%;
    }
  }
</style>

<div class="container-fluid px-3 px-md-4 mt-4">

  <!-- Heading -->
  <h2 class="text-center mb-4 glass-heading">
    STUDENT APPLICATIONS
  </h2>

  <!-- Table Wrapper -->
  <div class="table-responsive shadow-lg rounded-3 glass-table">

    <table class="table table-bordered table-striped align-middle mb-0 text-nowrap">
      <thead class="table-dark text-center">
        <tr>
          <th>#</th>
          <th>Student</th>
          <th>Company</th>
          <th>Role</th>
          <th>Experience</th>
          <th>Skills</th>
          <th>Resume</th>
          <th>Status</th>
          <th>Applied On</th>
        </tr>
      </thead>

      <tbody>
        {% for app in applications %}
        <tr>

          <td class="fw-semibold text-center">{{ loop.index }}</td>

          <td data-label="Student">
            <strong>{{ app[1] }}</strong><br>
            <small class="text-muted">{{ app[2] }}</small>
          </td>

          <td data-label="Company">{{ app[3] }}</td>
          <td data-label="Role">{{ app[4] }}</td>

          <td data-label="Experience">
            {{ app[5] or "Not Provided" }}
          </td>

          <td data-label="Skills">
            <span class="d-inline-block text-truncate w-100">
              {{ app[6] or "Not Provided" }}
            </span>
          </td>

          <td data-label="Resume" class="text-center">
            {% if app[7] %}
              <a href="{{ url_for('static', filename='uploads/resumes/' + app[7]) }}"
                 class="resume-btn text-decoration-none">
                Download
              </a>
            {% else %}
              <span class="text-muted">No Resume</span>
            {% endif %}
          </td>

          <td data-label="Status">
            <form action="/admin/application/status/{{ app[0] }}"
                  method="POST"
                  class="d-flex flex-column gap-2">

              <select name="status" class="form-select form-select-sm">
                <option value="Applied" {% if app[8]=='Applied' %}selected{% endif %}>Applied</option>
                <option value="Shortlisted" {% if app[8]=='Shortlisted' %}selected{% endif %}>Shortlisted</option>
                <option value="Selected" {% if app[8]=='Selected' %}selected{% endif %}>Selected</option>
                <option value="Rejected" {% if app[8]=='Rejected' %}selected{% endif %}>Rejected</option>
              </select>

              <button type="submit" class="update-btn w-100">
                Update
              </button>
            </form>
          </td>

          <td data-label="Applied On" class="text-center">
            {{ app[9] }}
          </td>

        </tr>
        {% endfor %}
      </tbody>
    </table>

  </div>
</div>

{% endblock %}
